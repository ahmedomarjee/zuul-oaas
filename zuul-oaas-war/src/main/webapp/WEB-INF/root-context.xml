<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
       http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd">


    <!--////////// Root Context //////////-->

    <!--
        Activates detection of various annotations such as @PostConstruct, @Required, @Autowired, ...
        Note that this will *not* enable classpath scan and auto-registering of beans.
    -->
    <context:annotation-config />

    <!--
        Registers configuration properties for placeholders replacement.

        The first location points to the bundled properties file with default values.
        Location of the second file is specified by the environment variable 'zuul.config.file'
        and when exists, then it overrides the default values. This variable can be set via JNDI
        (see /META-INF/context.xml) or command line parameter (-Dzuul.config.file).
    -->
    <context:property-placeholder
            location="classpath*:/config/zuul-config.properties, file:${zuul.config.file}"
            ignore-resource-not-found="true"
            file-encoding="UTF-8" />

    <!-- Exports MBeans via JMX for monitoring -->
    <context:mbean-export />

    <!--
        Find and load all configs inside the core module.
    -->
    <context:component-scan base-package="cz.cvut.zuul.oaas.config" />

    <!--
        Find and load security configs (annotated by @EnableWebSecurity) from all modules into the
        root context. Spring Security cannot be initialized across more contexts. :(
    -->
    <context:component-scan base-package="cz.cvut.zuul.oaas" use-default-filters="false">
        <context:include-filter type="annotation"
                expression="org.springframework.security.config.annotation.web.configuration.EnableWebSecurity" />
        <context:include-filter type="annotation"
                expression="org.springframework.security.config.annotation.web.servlet.configuration.EnableWebMvcSecurity" />
    </context:component-scan>

</beans>
